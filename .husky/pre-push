#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# AutoGeorge Pre-Push Hook - Backup Database
echo "ğŸ’¾ Creating safety backup before push..."

# Create backup
if ./scripts/backup-database.sh; then
  echo "âœ… Database backup completed"
else
  echo "âš ï¸  Database backup failed (continuing push)"
fi

# Create git tag for this push
TIMESTAMP=$(date +"%Y%m%d_%H%M%S")
COMMIT_HASH=$(git rev-parse --short HEAD)
TAG_NAME="pre-push-backup-$TIMESTAMP-$COMMIT_HASH"

git tag -a "$TAG_NAME" -m "Pre-push backup: $TIMESTAMP"
echo "ğŸ·ï¸  Created backup tag: $TAG_NAME"

echo "ğŸš€ Push safety backup completed"